# PRFAQ Pro 数据库结构说明

## 当前数据库状态
- 数据库文件大小: 1224.00 KB
- 总表数量: 6


## bills 表
当前记录数: 515

```sql
CREATE TABLE bills (
    bill_id INTEGER PRIMARY KEY,
    user_id TEXT NOT NULL,
    timestamp TEXT NOT NULL,
    api_name TEXT NOT NULL,
    operation TEXT NOT NULL,
    input_letters INTEGER NOT NULL,
    output_letters INTEGER NOT NULL,
    total_cost REAL NOT NULL,
    points_cost INTEGER DEFAULT 0
);
```

外键关系：
- user_id -> users(user_id)


## history 表
当前记录数: 259

```sql
CREATE TABLE history (
    history_id INTEGER PRIMARY KEY,
    user_id TEXT NOT NULL,
    timestamp TEXT NOT NULL,
    type TEXT NOT NULL,
    content TEXT NOT NULL,
    test_results TEXT ,
    input_text TEXT ,
    output_text TEXT 
);
```

外键关系：
- user_id -> users(user_id)


## point_transactions 表
当前记录数: 147

```sql
CREATE TABLE point_transactions (
    transaction_id INTEGER PRIMARY KEY,
    user_id TEXT NOT NULL,
    timestamp TEXT NOT NULL,
    type TEXT NOT NULL,
    amount INTEGER NOT NULL,
    balance INTEGER NOT NULL,
    description TEXT NOT NULL,
    operation_id TEXT 
);
```

外键关系：
- user_id -> users(user_id)


## recharge_records 表
当前记录数: 0

```sql
CREATE TABLE recharge_records (
    recharge_id INTEGER PRIMARY KEY,
    user_id TEXT NOT NULL,
    timestamp TEXT NOT NULL,
    amount INTEGER NOT NULL,
    payment_method TEXT NOT NULL,
    payment_status TEXT NOT NULL,
    transaction_id TEXT ,
    points_added INTEGER NOT NULL
);
```

外键关系：
- user_id -> users(user_id)


## sqlite_sequence 表
当前记录数: 3

```sql
CREATE TABLE sqlite_sequence (
    name  ,
    seq  
);
```


## users 表
当前记录数: 7

```sql
CREATE TABLE users (
    user_id TEXT PRIMARY KEY,
    username TEXT NOT NULL,
    password TEXT NOT NULL,
    email TEXT ,
    phone TEXT ,
    org_name TEXT ,
    role TEXT NOT NULL,
    is_active INTEGER NOT NULL,
    created_at TEXT NOT NULL,
    last_login TEXT ,
    total_chars INTEGER DEFAULT 0,
    total_cost REAL DEFAULT 0.0,
    daily_chars_limit INTEGER DEFAULT 100000,
    used_chars_today INTEGER DEFAULT 0,
    points INTEGER DEFAULT 1000
);
```

索引：
- sqlite_autoindex_users_2: (username)
- sqlite_autoindex_users_1: (user_id)


## 表关系说明
1. users 表是核心表，存储用户基本信息
2. bills 表通过 user_id 关联到 users 表，记录用户的积分变动
3. history 表通过 user_id 关联到 users 表，记录用户的操作历史
4. point_transactions 表通过 user_id 关联到 users 表，记录积分交易详情
5. recharge_records 表通过 user_id 关联到 users 表，记录充值记录
